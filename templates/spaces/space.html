<!DOCTYPE html>
<html lang="en">
    <head>
      <title>MakersBnB</title>
      <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
      <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:opsz@6..12&family=Roboto&display=swap" rel="stylesheet">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <meta charset="UTF-8">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
      <!-- Include Bootstrap Datepicker JavaScript -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
    
      <script>
        $(document).ready(function() {
            $('#datepicker').datepicker({
                format: 'yyyy-mm-dd',
                beforeShowDay: function(date) {
                    // Convert date to milliseconds since the Unix epoch
                    var epochDate = date.getTime(); 
                    
                    // Convert epoch date to formatted date
                    var formattedDate = new Date(epochDate).toISOString().slice(0, 10);
                    
                    // Disable specific dates here
                    var disabledDates = ["2024-03-10", "2024-03-15", "2024-03-20"];
                    
                    // Check if formatted date is in disabledDates array
                    if (disabledDates.indexOf(formattedDate) != -1) {
                        return {
                            enabled: false,
                            classes: 'disabled-date' // Add a CSS class to visually indicate the disabled date
                        };
                    }
                    return {
                        enabled: true
                    };
                }
            });
            // Submit form data via AJAX
            $('#bookingForm').submit(function(event){
                        event.preventDefault(); // Prevent default form submission
                        var formData = $(this).serialize(); // Serialize form data
                        var spaceId = $('#spaceId').val(); // Retrieve space ID from hidden field
                        $.ajax({
                            url: '/spaces/<space_id>',
                            type: 'POST',
                            data: formData,
                            success: function(response) {
                                // Handle success response
                                console.log(response);
                            },
                            error: function(xhr, status, error) {
                                // Handle error
                                console.error(error);
                            }
                        });
                    });
                });
      </script>

      


        <div class="navbar">
            <div>
            <img class="primary-icon" src="{{ url_for('static', filename='images/makers-logo.png') }}" class="logo">
            </div>
    
            <ul class="nav-list" id="navi-list">
              <li class="list-item"><a href="index.html">Spaces</a></li>
              <li class="list-item"><a href="requests.html">Requests</a></li>
              <li class="list-item"><a href="list.html">List a space</a></li>
              <li class="list-item"><a href="signout.html">Signout</a></li>
            </ul>
        </div>

        <h1>{{space.name}}</h1>

        <!-- Can we add user name and review to a listing - add to user database, and pull into relevant routes -->

        <p>
        Location: {{space.location}} <br>
        Description: {{space.description}} <br>
        Price per night: {{space.price}}
        </p>

        <div class="container">
          <h1>Booking Form</h1>
          <form id="bookingForm">
              <div class="form-group">
                  <label for="datepicker">Select Date:</label>
                  <input type="text" class="form-control" id="datepicker" name="date_booked">
              </div>
              <button type="submit" class="btn btn-primary">Submit</button>
              <input type="hidden" name="space_id" value="{{space.id}}">
              <input type="hidden" name="approver_id" value="{{space.user_id}}">
          </form>
        </div>

        <div>
            <form class = "grid" action ="/spaces/space_id" method = "POST">
                <input type="Submit" class="file_submit">
            </form>
        </div>
      
        <!-- Include Bootstrap Bundle JavaScript -->

    
    </body>
</html>